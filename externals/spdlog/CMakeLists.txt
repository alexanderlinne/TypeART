set(CMAKE_POSITION_INDEPENDENT_CODE ON)

set(SPDLOG_NO_EXCEPTIONS ON)
set(SPDLOG_FMT_EXTERNAL ON)

FetchContent_Declare(
  spdlog
  GIT_REPOSITORY https://github.com/gabime/spdlog
  GIT_SHALLOW 1
  GIT_TAG v1.9.2
)

FetchContent_MakeAvailable(spdlog)

mark_as_advanced(
  SPDLOG_BUILD_ALL
  SPDLOG_BUILD_BENCH
  SPDLOG_BUILD_EXAMPLE
  SPDLOG_BUILD_EXAMPLE_HO
  SPDLOG_BUILD_SHARED
  SPDLOG_BUILD_TESTS
  SPDLOG_BUILD_TESTS_HO
  SPDLOG_BUILD_WARNINGS
  SPDLOG_CLOCK_COARSE
  SPDLOG_DISABLE_DEFAULT_LOGGER
  SPDLOG_ENABLE_PCH
  SPDLOG_FMT_EXTERNAL_HO
  SPDLOG_INSTALL
  SPDLOG_NO_ATOMIC_LEVELS
  SPDLOG_NO_EXCEPTIONS
  SPDLOG_NO_THREAD_ID
  SPDLOG_NO_TLS
  SPDLOG_PREVENT_CHILD_FD
  SPDLOG_SANITIZE_ADDRESS
  SPDLOG_TIDY
  SPDLOG_WCHAR_FILENAMES
  SPDLOG_WCHAR_SUPPORT
)

mark_as_advanced(
  FETCHCONTENT_SOURCE_DIR_SPDLOG
  FETCHCONTENT_UPDATES_DISCONNECTED_SPDLOG
)

set(TARGETS_EXPORT_NAME ${CONFIG_NAME}Targets)

install(
  TARGETS spdlog
  EXPORT ${TARGETS_EXPORT_NAME}
)

install(
  EXPORT ${TARGETS_EXPORT_NAME}
  NAMESPACE spdlog::
  DESTINATION ${TYPEART_INSTALL_CONFIGDIR}
)

export(
  EXPORT ${TARGETS_EXPORT_NAME}
  FILE ${CMAKE_BINARY_DIR}/${TARGETS_EXPORT_NAME}.cmake
  NAMESPACE typeart::
)
